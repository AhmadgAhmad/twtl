TODO [code_opt]: Code optimization 
TODO [build_code]: 
TODO [sanity check]: 